@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    var expectedCode = ViewBag.CodeConfirmation;
    var expectedPhoneNumber = ViewBag.Numero;
}

<h2>Veuillez entrer le code que vous avez reçu par sms:</h2>

<div class="row">
    <div class="col-md-4">
        <form id="confirmationForm" method="post" asp-action="resetPassword" asp-controller="Utilisateurs">

            <div class="form-floating mb-3">
                <input name="confirmationCode" id="confirmationCode" class="form-control" placeholder="Numéro de confirmation" />
                <label for="confirmationCode">Numéro de confirmation</label>
            </div>
            <input type="hidden" name="numero" value="@expectedPhoneNumber" />


            <button type="button" id="submitBtn" class="btn btn-dark" onclick="validateAndSubmit()">Confirmer</button>
        </form>
    </div>
</div>

<script>
    function validateAndSubmit() {
        var expectedCode = '@expectedCode'.trim().toLowerCase();
        console.log(expectedCode);
        var enteredCode = document.getElementById('confirmationCode').value.trim().toLowerCase();

        if (enteredCode === expectedCode) {
            document.getElementById('confirmationForm').submit();
        } else {
            alert('Le code ou le numéro de téléphone est incorrect.');
        }
    }
</script>

